<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snap Camera Kit Test</title>

  <!-- ‚úÖ Load the prebuilt Camera Kit library -->
  <script src="https://unpkg.com/@snap/camera-kit@latest/dist/camera-kit.js"></script>

  <script>
    // ü™™ Your Camera Kit API Token
    const JSON_WEB_TOKEN = "eyJhbGciOiJIUzI1NiIsImtpZCI6IkNhbnZhc1MyU0hNQUNQcm9kIiwidHlwIjoiSldUIn0.eyJhdWQiOiJjYW52YXMtY2FudmFzYXBpIiwiaXNzIjoiY2FudmFzLXMyc3Rva2VuIiwibmJmIjoxNzYxNTY4NjI5LCJzdWIiOiI5MzYxNzYzZi1mZjgzLTRmOWItYmNiNC0wMGMwMzI1MDU1Y2V-U1RBR0lOR35iZmY5MjBmYy1kZDQ2LTQwMjYtYjczNC01NTNlOWQwYzA2OTgifQ.PMUnOz7IkERMzw8nL7iPjkdGFptauz5yA2piCiJWZV4";

    // üëÅÔ∏è Your Lens Group ID
    const DEFAULT_GROUP_KEY = "71a776e8-19d7-42c1-a8c3-e8c84ddfc755";

    window.addEventListener("load", async () => {
      try {
        const { bootstrapCameraKit, Transform2D } = window.CameraKit;

        console.log("üöÄ Initializing Camera Kit...");
        const cameraKit = await bootstrapCameraKit({ apiToken: JSON_WEB_TOKEN });

        const session = await cameraKit.createSession();
        session.events.addEventListener("error", (e) =>
          console.error("Lens error:", e.detail)
        );

        // Replace placeholder with camera canvas
        document.getElementById("canvas-output").replaceWith(session.output.live);

        console.log("üì¶ Loading lenses...");
        const { lenses } = await cameraKit.lensRepository.loadLensGroups([DEFAULT_GROUP_KEY]);

        if (!lenses || lenses.length === 0) {
          console.error("‚ùå No lenses found. Check your Lens Group ID.");
          return;
        }

        console.log("‚ú® Applying first lens:", lenses[0].name);
        await session.applyLens(lenses[0]);

        // Access webcam
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        const source = cameraKit.createMediaStreamSource(stream);
        source.setTransform(Transform2D.MirrorX);
        await session.setSource(source);

        // Start rendering
        session.play("live");
        console.log("‚úÖ Camera Kit ready! You should see the lens effect now.");
      } catch (error) {
        console.error("‚ùå Camera Kit initialization failed:", error);
      }
    });
  </script>
</head>

<body
  style="margin:0; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; background:#111; color:white;"
>
  <h2>üé• Snap Camera Kit Test</h2>
  <div
    id="canvas-output"
    style="width:90vw; height:70vh; background:#222; display:flex; align-items:center; justify-content:center;"
  >
    <span>Loading Camera...</span>
  </div>
</body>
</html>
